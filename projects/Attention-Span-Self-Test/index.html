<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attention Span Self-Test</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        :root {
            --primary: #4a6fa5;
            --primary-dark: #385d8a;
            --secondary: #6d9dc5;
            --accent: #ff9a76;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        body {
            background-color: #f0f5ff;
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background-color: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
            margin: 20px 0;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .test-section {
            padding: 20px;
        }
        
        .control-panel {
            background-color: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            height: 100%;
        }
        
        .settings {
            margin-bottom: 30px;
        }
        
        h2 {
            color: var(--primary-dark);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        h3 {
            color: var(--gray);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: #e9ecef;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: #dee2e6;
        }
        
        .btn-large {
            width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        .indicator-container {
            position: relative;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0 30px;
            border-radius: 15px;
            background-color: #f8f9fa;
            overflow: hidden;
            border: 2px dashed #dee2e6;
        }
        
        .indicator {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background-color: #e9ecef;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.05);
        }
        
        .indicator.active {
            background-color: var(--accent);
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 154, 118, 0.4);
        }
        
        .indicator-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--gray);
            transition: var(--transition);
        }
        
        .indicator.active .indicator-text {
            color: white;
        }
        
        .pulse {
            position: absolute;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background-color: rgba(74, 111, 165, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.3); opacity: 0; }
        }
        
        .timer {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary);
            text-align: center;
            margin: 20px 0;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            flex: 1;
            min-width: 120px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .feedback {
            background-color: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid var(--primary);
        }
        
        .feedback h3 {
            color: var(--primary-dark);
            margin-bottom: 15px;
        }
        
        .feedback-message {
            font-size: 1.1rem;
            line-height: 1.7;
        }
        
        .score-display {
            font-size: 3rem;
            font-weight: 800;
            text-align: center;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .meter {
            height: 12px;
            background-color: #e9ecef;
            border-radius: 6px;
            margin: 25px 0;
            overflow: hidden;
        }
        
        .meter-fill {
            height: 100%;
            background: linear-gradient(to right, var(--danger), var(--warning), var(--success));
            width: 0%;
            transition: width 1s ease;
        }
        
        .settings-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .setting {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        .instructions {
            background-color: #f0f7ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .instructions ul {
            padding-left: 20px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .result-section {
            display: none;
        }
        
        .result-section.active {
            display: block;
        }
        
        .attention-levels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                transition: none !important;
                animation: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> Attention Span Self-Test</h1>
            <p class="subtitle">Measure how long you can maintain focus without reacting too early or too late. Based on psychological principles of sustained attention.</p>
        </header>
        
        <div class="main-content">
            <div class="test-section">
                <h2>Focus Test</h2>
                <p>Click the button below to start. When the circle changes color, click it as quickly as possible. Don't click too early!</p>
                
                <div class="indicator-container">
                    <div class="indicator" id="visualIndicator">
                        <div class="indicator-text">Wait for the change</div>
                    </div>
                </div>
                
                <div class="timer" id="timer">--</div>
                
                <button class="btn btn-primary btn-large" id="startBtn">
                    <i class="fas fa-play-circle"></i> Start Focus Test
                </button>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="reactionTime">--</div>
                        <div class="stat-label">Reaction Time (ms)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="attemptCount">0</div>
                        <div class="stat-label">Attempts</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="accuracyScore">--</div>
                        <div class="stat-label">Accuracy Score</div>
                    </div>
                </div>
                
                <div class="instructions">
                    <h3><i class="fas fa-info-circle"></i> Test Instructions</h3>
                    <ul>
                        <li>Click "Start Focus Test" to begin</li>
                        <li>Wait for the circle to change color (will be randomized)</li>
                        <li>Click the circle as soon as it changes</li>
                        <li>Clicking too early will penalize your score</li>
                        <li>Try to maintain focus throughout the test</li>
                    </ul>
                </div>
            </div>
            
            <div class="control-panel">
                <h2>Settings & Results</h2>
                
                <div class="settings">
                    <h3>Test Settings</h3>
                    <div class="settings-options">
                        <div class="setting">
                            <span><i class="fas fa-volume-mute"></i> Sound-Free Mode</span>
                            <label class="toggle">
                                <input type="checkbox" id="soundToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting">
                            <span><i class="fas fa-eye"></i> Reduced Motion</span>
                            <label class="toggle">
                                <input type="checkbox" id="motionToggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting">
                            <span><i class="fas fa-palette"></i> Calm UI Mode</span>
                            <label class="toggle">
                                <input type="checkbox" id="calmUIToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="result-section" id="resultSection">
                    <h3>Your Attention Score</h3>
                    <div class="score-display" id="finalScore">--</div>
                    
                    <div class="meter">
                        <div class="meter-fill" id="accuracyMeter"></div>
                    </div>
                    <div class="attention-levels">
                        <span>Low</span>
                        <span>Average</span>
                        <span>High</span>
                    </div>
                    
                    <div class="feedback">
                        <h3>Feedback</h3>
                        <div class="feedback-message" id="feedbackMessage">
                            Complete the test to see your personalized feedback based on psychological attention span research.
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary btn-large" id="retryBtn">
                        <i class="fas fa-redo"></i> Retry Test
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>This interactive test measures sustained attention based on psychological principles. Results are for informational purposes only.</p>
            <p>Â© 2023 Attention Span Self-Test | Psychology & Human-Behavior Interactive UI</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const startBtn = document.getElementById('startBtn');
        const visualIndicator = document.getElementById('visualIndicator');
        const timerElement = document.getElementById('timer');
        const reactionTimeElement = document.getElementById('reactionTime');
        const attemptCountElement = document.getElementById('attemptCount');
        const accuracyScoreElement = document.getElementById('accuracyScore');
        const resultSection = document.getElementById('resultSection');
        const finalScoreElement = document.getElementById('finalScore');
        const accuracyMeter = document.getElementById('accuracyMeter');
        const feedbackMessage = document.getElementById('feedbackMessage');
        const retryBtn = document.getElementById('retryBtn');
        const soundToggle = document.getElementById('soundToggle');
        const motionToggle = document.getElementById('motionToggle');
        const calmUIToggle = document.getElementById('calmUIToggle');
        
        // Test variables
        let testActive = false;
        let reactionStartTime = 0;
        let reactionEndTime = 0;
        let waitTimer = null;
        let maxWaitTime = 0;
        let attempts = 0;
        let prematureClicks = 0;
        let totalReactionTime = 0;
        let successfulAttempts = 0;
        
        // Sound effects
        const changeSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3');
        const successSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3');
        const errorSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3');
        
        // Set sound volume
        changeSound.volume = 0.3;
        successSound.volume = 0.3;
        errorSound.volume = 0.3;
        
        // Initialize
        function init() {
            updateStats();
            startBtn.addEventListener('click', startTest);
            visualIndicator.addEventListener('click', handleIndicatorClick);
            retryBtn.addEventListener('click', resetTest);
            
            // Settings event listeners
            soundToggle.addEventListener('change', toggleSound);
            motionToggle.addEventListener('change', toggleMotion);
            calmUIToggle.addEventListener('change', toggleCalmUI);
            
            // Apply initial calm UI setting
            if (calmUIToggle.checked) {
                document.body.style.backgroundColor = '#f8f9fa';
            }
        }
        
        // Start the test
        function startTest() {
            if (testActive) return;
            
            resetTestState();
            testActive = true;
            startBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-hourglass-half"></i> Test Active - Wait for Change';
            startBtn.classList.remove('btn-primary');
            startBtn.classList.add('btn-secondary');
            
            // Random delay between 3 and 10 seconds
            const delay = Math.floor(Math.random() * 7000) + 3000;
            maxWaitTime = delay + 2000; // Give 2 seconds to react after change
            
            // Start countdown timer
            let seconds = Math.ceil(delay / 1000);
            timerElement.textContent = `Wait: ${seconds}s`;
            
            const countdown = setInterval(() => {
                seconds--;
                if (seconds > 0) {
                    timerElement.textContent = `Wait: ${seconds}s`;
                } else {
                    clearInterval(countdown);
                    timerElement.textContent = "Get ready...";
                }
            }, 1000);
            
            // Set timer for when the indicator will change
            waitTimer = setTimeout(() => {
                if (!testActive) return;
                
                // Change the indicator
                visualIndicator.classList.add('active');
                visualIndicator.querySelector('.indicator-text').textContent = 'CLICK NOW!';
                
                // Play sound if enabled
                if (soundToggle.checked) {
                    changeSound.currentTime = 0;
                    changeSound.play().catch(e => console.log("Audio play failed:", e));
                }
                
                // Start reaction time measurement
                reactionStartTime = Date.now();
                timerElement.textContent = "0.00s";
                
                // Start reaction timer
                let reactionSeconds = 0;
                const reactionTimer = setInterval(() => {
                    if (!testActive) {
                        clearInterval(reactionTimer);
                        return;
                    }
                    
                    reactionSeconds += 0.01;
                    timerElement.textContent = reactionSeconds.toFixed(2) + "s";
                    
                    // If user takes too long (more than 2 seconds), end attempt
                    if (reactionSeconds > 2) {
                        clearInterval(reactionTimer);
                        endAttempt(false, "Too slow! You took more than 2 seconds to react.");
                    }
                }, 10);
                
            }, delay);
        }
        
        // Handle indicator click
        function handleIndicatorClick() {
            if (!testActive) return;
            
            // If indicator is not active yet, it's a premature click
            if (!visualIndicator.classList.contains('active')) {
                prematureClicks++;
                endAttempt(false, "Too early! Wait for the color change.");
                return;
            }
            
            // Calculate reaction time
            reactionEndTime = Date.now();
            const reactionTime = reactionEndTime - reactionStartTime;
            
            // Check if reaction was reasonable (between 150ms and 2000ms)
            if (reactionTime < 150) {
                endAttempt(false, "Too fast! That might be a guess rather than a reaction.");
            } else if (reactionTime > 2000) {
                endAttempt(false, "Too slow! You took more than 2 seconds to react.");
            } else {
                // Successful attempt
                successfulAttempts++;
                totalReactionTime += reactionTime;
                endAttempt(true, `Good reaction! ${reactionTime}ms`);
            }
        }
        
        // End the current attempt
        function endAttempt(success, message) {
            clearTimeout(waitTimer);
            testActive = false;
            
            // Update attempts
            attempts++;
            
            // Reset indicator
            visualIndicator.classList.remove('active');
            visualIndicator.querySelector('.indicator-text').textContent = 'Wait for the change';
            
            // Update stats
            updateStats();
            
            // Show feedback
            timerElement.textContent = message;
            
            // Play sound if enabled
            if (soundToggle.checked) {
                if (success) {
                    successSound.currentTime = 0;
                    successSound.play().catch(e => console.log("Audio play failed:", e));
                } else {
                    errorSound.currentTime = 0;
                    errorSound.play().catch(e => console.log("Audio play failed:", e));
                }
            }
            
            // After 2 seconds, enable next test
            setTimeout(() => {
                startBtn.disabled = false;
                startBtn.innerHTML = '<i class="fas fa-play-circle"></i> Next Test';
                startBtn.classList.remove('btn-secondary');
                startBtn.classList.add('btn-primary');
                
                // After 5 attempts, show final results
                if (attempts >= 5) {
                    showFinalResults();
                } else {
                    timerElement.textContent = '--';
                }
            }, 2000);
        }
        
        // Update statistics display
        function updateStats() {
            attemptCountElement.textContent = attempts;
            
            if (successfulAttempts > 0) {
                const avgReactionTime = Math.round(totalReactionTime / successfulAttempts);
                reactionTimeElement.textContent = avgReactionTime;
                
                // Calculate accuracy score (lower reaction time = higher score, penalized by premature clicks)
                let accuracy = Math.max(0, 1000 - avgReactionTime);
                accuracy = accuracy * (successfulAttempts / attempts);
                accuracyScoreElement.textContent = Math.round(accuracy);
            } else {
                reactionTimeElement.textContent = '--';
                accuracyScoreElement.textContent = '--';
            }
        }
        
        // Show final results
        function showFinalResults() {
            // Calculate final score
            let score = 0;
            
            if (successfulAttempts > 0) {
                const avgReactionTime = Math.round(totalReactionTime / successfulAttempts);
                score = Math.max(0, 1000 - avgReactionTime);
                score = score * (successfulAttempts / attempts);
                score = Math.round(score * 10); // Scale up for display
            }
            
            // Determine feedback based on score
            let feedback = "";
            let meterPercentage = 0;
            
            if (score < 300) {
                feedback = "Your attention span results indicate difficulty with sustained focus. This is common in today's digital world with constant distractions. Try practicing mindfulness or reducing multitasking.";
                meterPercentage = 30;
            } else if (score < 600) {
                feedback = "You have an average attention span. Most people lose focus after 8-10 seconds on simple tasks. Consider taking regular breaks during long tasks to maintain focus.";
                meterPercentage = 60;
            } else if (score < 800) {
                feedback = "Good attention span! You're better than average at maintaining focus. Research shows the average attention span has decreased to about 8 seconds, but you're performing above that.";
                meterPercentage = 80;
            } else {
                feedback = "Excellent attention span! You have strong sustained focus abilities. This skill is valuable for deep work and complex tasks. Consider yourself in the top 20% for focused attention.";
                meterPercentage = 95;
            }
            
            // Update UI with results
            finalScoreElement.textContent = score;
            accuracyMeter.style.width = `${meterPercentage}%`;
            feedbackMessage.textContent = feedback;
            
            // Show result section
            resultSection.classList.add('active');
            
            // Scroll to results
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Reset the test
        function resetTest() {
            resetTestState();
            resultSection.classList.remove('active');
            timerElement.textContent = '--';
            startBtn.disabled = false;
            startBtn.innerHTML = '<i class="fas fa-play-circle"></i> Start Focus Test';
            startBtn.classList.remove('btn-secondary');
            startBtn.classList.add('btn-primary');
        }
        
        // Reset test state variables
        function resetTestState() {
            testActive = false;
            clearTimeout(waitTimer);
            reactionStartTime = 0;
            reactionEndTime = 0;
            attempts = 0;
            prematureClicks = 0;
            totalReactionTime = 0;
            successfulAttempts = 0;
            
            visualIndicator.classList.remove('active');
            visualIndicator.querySelector('.indicator-text').textContent = 'Wait for the change';
            
            updateStats();
        }
        
        // Toggle sound setting
        function toggleSound() {
            // Sound is already handled in the individual functions
            console.log("Sound setting changed:", soundToggle.checked);
        }
        
        // Toggle motion setting
        function toggleMotion() {
            if (motionToggle.checked) {
                document.documentElement.style.setProperty('--transition', 'none');
                // Remove pulse animation
                const pulseElement = document.querySelector('.pulse');
                if (pulseElement) {
                    pulseElement.style.animation = 'none';
                }
            } else {
                document.documentElement.style.setProperty('--transition', 'all 0.3s ease');
                // Restore pulse animation
                const pulseElement = document.querySelector('.pulse');
                if (pulseElement) {
                    pulseElement.style.animation = 'pulse 2s infinite';
                }
            }
        }
        
        // Toggle calm UI setting
        function toggleCalmUI() {
            if (calmUIToggle.checked) {
                document.body.style.backgroundColor = '#f8f9fa';
                document.querySelector('.indicator-container').style.backgroundColor = '#f1f3f5';
                document.querySelector('.control-panel').style.backgroundColor = '#f8f9fa';
            } else {
                document.body.style.backgroundColor = '#f0f5ff';
                document.querySelector('.indicator-container').style.backgroundColor = '#f8f9fa';
                document.querySelector('.control-panel').style.backgroundColor = '#f8f9fa';
            }
        }
        
        // Initialize the app
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>